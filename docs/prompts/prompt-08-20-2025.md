Do you see how plan_kafka_consumer.py and plan_kafka_producer.py pass in AIOKafkaConsumer / AIOKafkaProducer to the constructor?   in task_kafka_consumer.py and task_kafka_producer.py, move the creation of AIOKafkaConsumer / AIOKafkaProducer  to ExecutorService and pass it in the constructor in task_kafka_consumer.py and task_kafka_producer.py,

Do not touch the tests without asking


---

task_kafka_producer.py and plan_kafka_producer.py should be almost identital except for the types dealt with and topics/producer

---

update the task tests.  Look at the plan tests that use TestContainers Kafka, that's how I want kafka supplied for the tests

---

Use Testcontainers Kafka like test_plan_executor_integration.py and test_task_executor_integration.py, or

---

analyze plan_kafka_consumer.py and task_kafka_consumer.py.  Can TaskInputConsumer and PlanInputConsumer be refactored into a common base class?   Answer before acting

---
